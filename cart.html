<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart | Modern Store</title>
    <style>
        :root { --primary: #000; --bg: #f8f9fa; --red: #ff3b30; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 20px auto; background: #fff; padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        
        .cart-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #eee; padding-bottom: 15px; margin-bottom: 20px; }
        
        .item { display: grid; grid-template-columns: 80px 1fr auto auto; align-items: center; gap: 20px; padding: 20px 0; border-bottom: 1px solid #f0f0f0; }
        .item img { width: 80px; height: 80px; border-radius: 12px; object-fit: cover; }
        
        .item-info strong { display: block; font-size: 1.1rem; }
        .size-badge { display: inline-block; background: #eee; padding: 2px 8px; border-radius: 4px; font-size: 0.8rem; margin-top: 5px; font-weight: bold; }

        /* Quantity Controls */
        .qty-controls { display: flex; align-items: center; background: #f1f1f1; border-radius: 10px; padding: 4px; }
        .qty-btn { width: 30px; height: 30px; border: none; background: #fff; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .qty-btn:hover { background: var(--primary); color: white; }
        .qty-val { width: 40px; text-align: center; font-weight: bold; }

        .item-price { font-weight: bold; font-size: 1.1rem; min-width: 100px; text-align: right; }
        .remove-btn { color: var(--red); cursor: pointer; background: none; border: none; font-size: 1.2rem; padding: 10px; }

        .cart-summary { margin-top: 30px; background: #f9f9f9; padding: 25px; border-radius: 15px; }
        .summary-line { display: flex; justify-content: space-between; margin-bottom: 10px; color: #666; }
        .total-line { border-top: 2px solid #eee; padding-top: 15px; margin-top: 15px; font-size: 1.5rem; font-weight: bold; color: #000; }
        
        select { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; margin: 10px 0 20px 0; font-size: 1rem; }
        .checkout-btn { width: 100%; padding: 18px; background: var(--primary); color: white; border: none; border-radius: 12px; font-size: 1.1rem; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <div class="cart-header">
        <h1>Shopping Cart</h1>
        <a href="index.html" style="text-decoration: none; color: #666;">‚Üê Continue Shopping</a>
    </div>

    <div id="cart-list">
        </div>

    <div class="cart-summary">
        <label>Ship To:</label>
        <select id="citySelect" onchange="updateTotals()">
            <option value="">Select your city...</option>
            <option value="50">Cairo (50 EGP)</option>
            <option value="60">Giza (60 EGP)</option>
            <option value="70">Alexandria (70 EGP)</option>
            <option value="80">Other (80 EGP)</option>
        </select>

        <div class="summary-line"><span>Subtotal</span> <span id="subtotal">0 EGP</span></div>
        <div class="summary-line"><span>Shipping</span> <span id="shipping">0 EGP</span></div>
        <div class="total-line"><span>Total</span> <span id="total">0 EGP</span></div>
        
        <button class="checkout-btn" onclick="goToCheckout()">Proceed to Checkout</button>
    </div>
</div>

<script>
    // 1. Get data from storage
    function getCart() {
        return JSON.parse(localStorage.getItem("cart")) || [];
    }

    // 2. Save data to storage
    function saveCart(cart) {
        localStorage.setItem("cart", JSON.stringify(cart));
        renderCart(); // Redraw everything whenever data changes
    }

    // 3. Render the cart items
    function renderCart() {
        const cart = getCart();
        const list = document.getElementById("cart-list");
        list.innerHTML = "";

        if (cart.length === 0) {
            list.innerHTML = `<div style="text-align:center; padding:40px; color:#999;">Your cart is empty</div>`;
            updateTotals();
            return;
        }

        cart.forEach((item, index) => {
            const itemElement = document.createElement("div");
            itemElement.className = "item";
            itemElement.innerHTML = `
                <img src="${item.img}" alt="product">
                <div class="item-info">
                    <strong>${item.name}</strong>
                    <span class="size-badge">Size: ${item.size}</span>
                </div>
                <div class="qty-controls">
                    <button class="qty-btn" onclick="changeQuantity(${index}, -1)">-</button>
                    <span class="qty-val">${item.qty}</span>
                    <button class="qty-btn" onclick="changeQuantity(${index}, 1)">+</button>
                </div>
                <div class="item-price">${item.price * item.qty} EGP</div>
                <button class="remove-btn" onclick="deleteItem(${index})">üóëÔ∏è</button>
            `;
            list.appendChild(itemElement);
        });

        updateTotals();
    }

    // 4. Change Quantity (+/-)
    function changeQuantity(index, delta) {
        let cart = getCart();
        cart[index].qty += delta;

        if (cart[index].qty < 1) {
            deleteItem(index);
        } else {
            saveCart(cart);
        }
    }

    // 5. Delete Item
    function deleteItem(index) {
        let cart = getCart();
        cart.splice(index, 1);
        saveCart(cart);
    }

    // 6. Update Totals & Shipping
    function updateTotals() {
        const cart = getCart();
        const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
        const shipping = parseInt(document.getElementById("citySelect").value) || 0;
        const total = subtotal + shipping;

        document.getElementById("subtotal").innerText = `${subtotal} EGP`;
        document.getElementById("shipping").innerText = `${shipping} EGP`;
        document.getElementById("total").innerText = `${total} EGP`;

        // Save for the next pages
        localStorage.setItem("tempTotal", total);
    }

    // 7. Navigation
    function goToCheckout() {
        const cart = getCart();
        const ship = document.getElementById("citySelect").value;

        if (cart.length === 0) return alert("Cart is empty");
        if (!ship) return alert("Please select a city");

        // Save selected city name (not just the price)
        const cityDropdown = document.getElementById("citySelect");
        const cityName = cityDropdown.options[cityDropdown.selectedIndex].text.split(' (')[0];
        localStorage.setItem("selectedGovernorate", cityName);

        window.location.href = "checkout.html";
    }

    // Start
    renderCart();
</script>

</body>
</html>
