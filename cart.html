<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>سلة الشراء</title>
    <style>
        body { font-family: Arial; background:#f5f5f5; padding:20px; }
        .item { background:#fff; padding:10px; margin-bottom:10px; display:flex; justify-content:space-between; align-items:center; }
        .controls button { padding:5px; cursor:pointer; width:30px; }
    </style>
</head>
<body>

<h1>سلة الشراء</h1>
<button onclick="window.location.href='index.html'">⬅ العودة للمتجر</button>
<hr>

<div id="cartList"></div>
<h3>الإجمالي: <span id="totalPrice">0</span> جنيه</h3>

<script>
    function renderCart() {
        let cart = [];
        try {
            cart = JSON.parse(localStorage.getItem("cart")) || [];
        } catch(e) { 
            localStorage.removeItem("cart");
            cart = [];
        }

        const list = document.getElementById("cartList");
        let total = 0;
        list.innerHTML = "";

        if(cart.length === 0) {
            list.innerHTML = "<p>السلة فارغة</p>";
        }

        cart.forEach((item, index) => {
            total += (item.price * item.qty);
            const div = document.createElement("div");
            div.className = "item";
            div.innerHTML = `
                <div>${item.name} (${item.price} ج)</div>
                <div class="controls">
                    <button onclick="changeQty(${index}, -1)">-</button>
                    <span>${item.qty}</span>
                    <button onclick="changeQty(${index}, 1)">+</button>
                    <button onclick="remove(${index})">❌</button>
                </div>
            `;
            list.appendChild(div);
        });
        document.getElementById("totalPrice").innerText = total;
    }

    function changeQty(index, amount) {
        let cart = JSON.parse(localStorage.getItem("cart"));
        cart[index].qty += amount;
        if(cart[index].qty <= 0) cart.splice(index, 1);
        localStorage.setItem("cart", JSON.stringify(cart));
        renderCart();
    }

    function remove(index) {
        let cart = JSON.parse(localStorage.getItem("cart"));
        cart.splice(index, 1);
        localStorage.setItem("cart", JSON.stringify(cart));
        renderCart();
    }

    window.addEventListener('pageshow', renderCart);
    renderCart();
</script>
</body>
</html>


