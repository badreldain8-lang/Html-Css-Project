<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Cart</title>
<style>
body { font-family: Arial; background:#f5f5f5; margin:20px; }
img { width:80px; vertical-align:middle; margin-right:10px; }
button { padding:5px 10px; cursor:pointer; margin-left:5px; }
.qty { width:30px; text-align:center; }
</style>
</head>
<body>

<h2>ğŸ›’ Ø§Ù„Ø³Ù„Ø©</h2>
<div id="items"></div>

<p>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ù„Ù„Ø´Ø­Ù†:</p>
<select id="governorate">
  <option value="">-- Ø§Ø®ØªØ± --</option>
  <option value="cairo">Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
  <option value="giza">Ø§Ù„Ø¬ÙŠØ²Ø©</option>
  <option value="alex">Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©</option>
  <option value="other">Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª</option>
</select>

<p>Ø³Ø¹Ø± Ø§Ù„Ø´Ø­Ù†: <span id="shipping">0</span> Ø¬Ù†ÙŠÙ‡</p>
<p>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="total">0</span> Ø¬Ù†ÙŠÙ‡</p>

<button onclick="goCheckout()">Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>

<script>
let cart = JSON.parse(localStorage.getItem("cart")) || [];
let box = document.getElementById("items");
let subtotal = 0;
let shippingCost = 0;

function render(){
  const gov = document.getElementById("governorate").value;
  box.innerHTML = "";
  subtotal = 0;

  if(cart.length === 0){
    box.innerHTML = "Ø§Ù„Ø³Ù„Ø© ÙØ§Ø¶ÙŠØ©";
    shippingCost = 0;
  } else {
    cart.forEach((item,i)=>{
      subtotal += item.price * (item.qty || 1);
      box.innerHTML += `
        <p>
          <img src="${item.img}" alt="${item.name}">
          ${item.name} - ${item.price} Ø¬Ù†ÙŠÙ‡
          <button onclick="decreaseQty(${i})">-</button>
          <input type="text" class="qty" id="qty${i}" value="${item.qty}" readonly>
          <button onclick="increaseQty(${i})">+</button>
          <button onclick="removeItem(${i})">âŒ</button>
        </p>
      `;
    });
  }

  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø´Ø­Ù†
  if(gov==='cairo') shippingCost=50;
  else if(gov==='giza') shippingCost=60;
  else if(gov==='alex') shippingCost=70;
  else if(gov==='other') shippingCost=80;
  else shippingCost=0;

  document.getElementById("shipping").innerText = shippingCost;
  document.getElementById("total").innerText = subtotal+shippingCost;

  localStorage.setItem("cart", JSON.stringify(cart));
  updateCartIcon();
}


  document.getElementById("total").innerText = subtotal+shippingCost;
  localStorage.setItem("cart", JSON.stringify(cart));
  updateCartIcon();
}

function removeItem(i){
  cart.splice(i,1);
  render(); // ØªØ­Ø¯ÙŠØ« ÙƒØ§Ù…Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ø°Ù
}


function increaseQty(i){
  cart[i].qty++;
  render(); // ØªØ­Ø¯ÙŠØ« ÙƒØ§Ù…Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø²ÙŠØ§Ø¯Ø©
}

function decreaseQty(i){
  if(cart[i].qty>1) cart[i].qty--;
  else cart.splice(i,1);
  render(); // ØªØ­Ø¯ÙŠØ« ÙƒØ§Ù…Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ù‚Øµ
}
  
function updateShipping(){
  const gov = document.getElementById("governorate").value;
  if(gov==='cairo') shippingCost=50;
  else if(gov==='giza') shippingCost=60;
  else if(gov==='alex') shippingCost=70;
  else if(gov==='other') shippingCost=80;
  else shippingCost=0;

  document.getElementById("shipping").innerText = shippingCost;
  document.getElementById("total").innerText = subtotal+shippingCost;
}

function goCheckout(){
  const gov = document.getElementById("governorate").value;
  if(cart.length===0){
    alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø¶ÙŠØ©");
    return;
  }
  if(!gov){
    alert("Ù…Ù† ÙØ¶Ù„Ùƒ Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø£ÙˆÙ„Ø§Ù‹");
    return;
  }
  localStorage.setItem("selectedGovernorate", gov);
  window.location.href="checkout.html";
}

function updateCartIcon(){
  document.getElementById("cartCount").innerText = cart.length;
}

render();
document.getElementById("governorate").addEventListener("change", updateShipping);
</script>

<div class="cart-icon" style="display:none;">
  <span id="cartCount"></span>
</div>

</body>
</html>


