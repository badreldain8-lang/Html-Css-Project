<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fashion Store</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background:#f9f9f9; margin:0; padding:20px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; }
        .product-card { background: #fff; border-radius: 12px; padding: 15px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #eee; }
        .product-card img { width: 100%; height: 220px; object-fit: cover; border-radius: 8px; margin-bottom: 10px; }
        .brand { display: block; font-size: 0.7rem; color: #888; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .price { display: block; font-weight: bold; font-size: 1.1rem; color: #333; margin: 5px 0; }
        
        /* Size Selection Styling */
        .size-selector { width: 100%; padding: 8px; margin: 10px 0; border-radius: 5px; border: 1px solid #ddd; font-size: 0.9rem; background: #fff; }
        .add-btn { background: #000; color: #fff; border: none; padding: 12px; border-radius: 5px; cursor: pointer; width: 100%; font-weight: bold; }
        .cart-icon { background: #ff3b30; color: white; border-radius: 50px; padding: 10px 20px; font-weight: bold; cursor: pointer; text-decoration: none; }
    </style>
</head>
<body>

<div class="header">
    <h1>Fashion & Shoes</h1>
    <a href="cart.html" class="cart-icon">ðŸ›’ Cart (<span id="cartCount">0</span>)</a>
</div>

<div class="product-grid">
    <div class="product-card" id="prod-1">
        <img src="https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=500" alt="T-Shirt">
        <span class="brand">Urban Wear</span>
        <strong>Classic White Tee</strong>
        <span class="price">350 EGP</span>
        <select class="size-selector" id="size-1">
            <option value="">Choose Size</option>
            <option value="S">Small (S)</option>
            <option value="M">Medium (M)</option>
            <option value="L">Large (L)</option>
            <option value="XL">Extra Large (XL)</option>
        </select>
        <button class="add-btn" onclick="addToCart({id:1, name:'Classic White Tee', price:350, img:'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?q=80&w=500'}, 'size-1')">Add to Cart</button>
    </div>

    <div class="product-card" id="prod-2">
        <img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=500" alt="Shoes">
        <span class="brand">SportX</span>
        <strong>Red Running Shoes</strong>
        <span class="price">850 EGP</span>
        <select class="size-selector" id="size-2">
            <option value="">Choose Size</option>
            <option value="40">40</option>
            <option value="41">41</option>
            <option value="42">42</option>
            <option value="43">43</option>
            <option value="44">44</option>
        </select>
        <button class="add-btn" onclick="addToCart({id:2, name:'Red Running Shoes', price:850, img:'https://images.unsplash.com/photo-1542291026-7eec264c27ff?q=80&w=500'}, 'size-2')">Add to Cart</button>
    </div>
</div>

<script>
function updateCartIcon(){
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const count = cart.reduce((sum,item)=>sum + item.qty,0);
    document.getElementById("cartCount").innerText = count;
}

function addToCart(product, sizeId){
    const selectedSize = document.getElementById(sizeId).value;
    
    // VALIDATION: Stop if no size is selected
    if(!selectedSize){
        alert("Please select a size before adding to cart!");
        return;
    }

    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    // We check if the same product WITH the same size already exists
    const existing = cart.find(p => p.id === product.id && p.size === selectedSize);

    if(existing) { 
        existing.qty++; 
    } else { 
        cart.push({...product, size: selectedSize, qty:1}); 
    }
    
    localStorage.setItem("cart", JSON.stringify(cart));
    updateCartIcon();
    alert(`Added ${product.name} (Size: ${selectedSize}) to cart!`);
}

window.addEventListener('pageshow', updateCartIcon);
updateCartIcon();
</script>
</body>
</html>
