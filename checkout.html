<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>بيانات الشحن</title>
<style>body{direction:rtl; padding:20px; font-family:Arial;} input{width:100%; padding:10px; margin:10px 0; border:1px solid #ccc;}</style>
</head>
<body>
<h2>إكمال بيانات العميل</h2>
<form id="checkoutForm">
  <label>الاسم:</label><input type="text" id="customerName">
  <label>العنوان:</label><input type="text" id="customerAddress">
  <label>رقم الهاتف:</label><input type="text" id="customerPhone">
  <label>المحافظة:</label><input type="text" id="customerGovernorate" readonly>
  <button type="button" onclick="confirmOrder()" style="width:100%; padding:15px; background:blue; color:white; border:none; cursor:pointer;">تأكيد وحفظ الطلب</button>
</form>

<script>
document.getElementById("customerGovernorate").value = localStorage.getItem("selectedGovernorate");

function confirmOrder(){
  const name = document.getElementById("customerName").value;
  const address = document.getElementById("customerAddress").value;
  const phone = document.getElementById("customerPhone").value;
  const cart = JSON.parse(localStorage.getItem("cart"));

  if(!name || !address || !phone) return alert("اكمل كل البيانات");

  const orderNumber = Math.floor(Math.random()*1000000);
  const orderData = { orderNumber, cart, customer: {name, address, phone}, total: localStorage.getItem("tempTotal") };

  let orders = JSON.parse(localStorage.getItem("orders")) || [];
  orders.push(orderData);
  localStorage.setItem("orders", JSON.stringify(orders));
  
  // Clear cart now
  localStorage.removeItem("cart");
  window.location.href=`payment.html?order=${orderNumber}&total=${orderData.total}`;
}
</script>
</body>
</html>
